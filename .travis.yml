sudo: required
language: ruby
services:
- postgresql
- mysql
- docker
rvm:
- 2.6.5
cache: bundler
before_script:
- psql -c 'create database fedora_ingest_rails_test;' -U postgres
- mysql -uroot -e 'CREATE DATABASE ami_filestore_test; CREATE DATABASE image_filestore_test'
- mysql -uroot ami_filestore_test < ./db/resources/ami_filestore_schema.sql
- mysql -uroot image_filestore_test < ./db/resources/image_filestore_schema.sql
script:
- bundle exec rspec
after_success:
- provisioning/travis_ci_and_cd/build_and_push_to_ecr.sh
- provisioning/travis_ci_and_cd/ecs_deploy.sh
env:
  global:
  - secure: BQA/0MRMKkMNdInR++PDFk6i9skBvXkRUT+CbKULhZh9Z3TVRiDQ9gAP4x0ev8mdhQIL6Ge2Yx16VodqGvix6IFKaZgmfwajyb31KsPzHqXAEkn4A4Dx2BXuc7rG2V+0Mwqdjmb6cu+AxRCIzd4n+XfevtTWcbrZOR+dYewhQdvpkltWWo1B8eZt61p4Uj3iY5fZnd9VDKlX9p1w1nrdLey0OJcQ91wS28zrNgOK9eQBZWiV6pSTjpZ65VdFEdB7gHvpB/Usvk1ua1BVKSpQXp+3ubiGOBru/AhemC3FoycxDRYPFT/A2o+FYPMicLD/MMPr3f/YwXV04DzthTkzXa7TJiM3aCdAkFUtlZ7Xr7QbSWDGeUZbPulf61RwBVvaQXs9+2+HfzUVqXyJX/H554aD2nLEe0vpFmoeM0OmV+XuYLz1oUxfxem8m0fZP6wRF2hL3t0HLQjIqDD9XPFJqUKAR2epvdML7gX34XDLTpBdPeHr6lxOe4ws8948JB6tcATVdpUxjMJj3hnuC0+awXBHyNMU/o5K6W5pzFw6vuVKsKk3d+bJ1yxs75R0TdjxYHQRxJZP520SUXSWLy5scBMIEHOH6OwWGji966Oo042JBPm6yc7kDJ4FT+kduH9Rd3Mk2KWjx49gLrFxBMc4g+IEcQ9OJMRC4FJZb4aWGjI=
  - secure: Er/qsDMZeDL+cTxu/5amzoYk0wM/tsxNgaApy425PTJRLT713DUteQieHX5SpJkKRKFAIVe4KZWDuYV7rnMNPgWc2q9REmtoK1Xw3Hb/xcfR/I9MgqnzYXBJm/y32J5/k91s4ziniDxjBKbK1s4jeu8CZ3dq+XSmLxkVs6iWdMmpO0lCmJz/DAyaB6M1tKiT6u2Y4rwp5dXJ52X25Z+w6fGp34WHDXmzsUVsaNEf5Nhjsm9pUORh59oKDJThkO52EXMiCq92gQGiXAq5d8B8qt5ha/GCs8ZYyklohc/w9ge6AM4fjkZufZK1IHi3RVAo7QKyK+4jejD8n8K9Qldtl6ROacheV/SL3kJwfYfiwF3dC7PsOcAno2OBDgu0gFi03zBlK05zITqe+jX4cuBbV3w0CW0j2+tY4lP1ldQyZGaPbP8SbuvgYjE4CYrylEEziMwUYdobO5ZBOcp2hlFRvhcN6CSYGDk+4jFWkiZWybeh/YAF3SszTIXrpU0iXw9YkijzgAvBSngc16jxvEnnvpNocR7xHUYSmda1tFXa9o0vxLIPibObozXtGbBWr1dqxmHfsqo5fKvH7s9Cj2ddY+KMRYTyyIIMlOUfxui4JgnGNlz5EM/ac+VjScv216MFJ2PUF58sOO+bPMtFDXe4LnWwUzSOjfVqOL2nj9KnJko=
  - secure: FS9dwGKQOQ6/v6J2dBRl4i+3e+r6/BQ7jbpLGoT+81Urey9b4c1p8Emq8GS1Sr36DeClwRlw3oXt+nmPAka9x5MNxFyOCBMBVBZqt/WYIzmeSY1bhttypM9P5lXLy6+JYiZfLXrKxxUSD/3w/vJ6hB4jM7WMflF9GPshabi6k/OWFGmyWmCzGirVt9lraMuA96wq8l0YlBhDG/u56egaGESmvBL0hBJVtUnXYBjATPZVrlbc6gTjS2Dn3wFUGal4QYd7nSZ2Stp/3ooMCATl8BJ8aum+qJi3RoWQgQciuBnlv3ZEG7hvFIXuJASLUcCi6k13b/Qj66blQjyWhYdna6skC87Dn4P1UtsOMCIFjBWJHOrzzaIQkLXWgVsvY2AgvgXB47bHHYtbYPB1qL+Yr5eGguIdNPVikGbvtA6RMyw5wRr1tNH+vRZrTAUqDmaz8ct/RSeot51UEb0IRIZJ8CRVhZMAjRwJRUSxNmpQR/NYWRvoosVb3lOe3sqil55BI50n6IW6QZybWxKgynwuTL7Lxps9bGOoLAplC+7FnkLrG/zYIFBy3pwPL51cMcNoMRj/QtvuY36quRFnRclZMMVb5vy7zH8bln5YGPsG+nOLCaCUomNdy6eb0Fi4nEJAMLc7An5KNBzRaA+TdxbTe569VZYstkd4CXi17Hvy+Ss=
  - secure: brkEsLIDc23Q+3HqLDA0sq8DXr/mQ0DfYWYJa1NgOMs8WMigkKkAy5yZNsQMkI7hAtvPUOiCdQz8o4/G68tCluw0vdUfpmVDWkWJbIFE/zpZkE1EALHYIc2j4PANvTVTrFRtBKxKZTYOsn8jQA0nAjTcN9mW7jqS9mEyt3AP6fMVV+Z19+vDZPP5L89AgUpiwoVOvcsaLlcxficuZTT7SNkvq29ifE3nAE7VjD6eUq9BTzbFzzF6pHUKqW4DHI2BWpi0Kxuxu1TdJiw5jhXP64gnescQAOGTuFAf3Epe9XZkUA6dx0XVsBRnqznr1M+PXM5NpsSvk6/JcWskD7E9UJUCBb7XzqR6QlA92z65Cx71betHpxqEmMzQy20b+eQ0BPkKUqDIQAcVCMxLaRZqVmpnNXiSIQQ+WY7dy727ZDjbWYNoO83HK1aMNNCCJ71oWpfghmQzCuJkvMTtAujScQ0cY4zHHDUgBa9R8stS9F87a8rosTS+dMa/noA+z72zN/z9RilNeew+vAr2neqizJIOMkXnHket2i8NGavkRKbUCOdUzu4f25FpPxP5RTFU18+brQpz74j+m1jAFQOZNgGVd5yMvQ2AsXYVJVRZvsNq6B4frRLOa1MsuV7qfvN1i4DDVrr8GvlEjvsTkRMcVUaA+D/4SmSX/kzDL1RMtcc=
